Please verify the changes you made. The code needs to align with the rest of the codebase.

It needs to be scalable and maintainable. Maybe you should clean something up. Add helper functions, or split into multiple files. 

It is essential that this code is robust and reliable. 

You should verify in the codebase if things are in a good state, and if not, list the issues and fix them. 