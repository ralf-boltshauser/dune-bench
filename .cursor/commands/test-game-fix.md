Now please identify a smart way to test the fix you have implemented. You try to make a smart fast test, but the more e2e it is the better. 

Make it minimalistic. 

Then take your learnings if things work, if not fix the issues identified. 

Iterate on this as long as it takes.